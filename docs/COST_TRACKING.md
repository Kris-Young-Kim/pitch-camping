# 비용 추적 문서 (Pitch Camping)

## 개요

이 문서는 Pitch Camping 서비스의 클라우드 인프라 비용을 추적하고 모니터링하기 위한 가이드입니다.

## 서비스별 비용 구조

### 1. Vercel (호스팅)

**무료 플랜 (Hobby)**:
- 대역폭: 100GB/월
- 함수 실행 시간: 100GB-hours/월
- 빌드: 무제한

**프로 플랜 ($20/월)**:
- 대역폭: 1TB/월
- 함수 실행 시간: 1,000GB-hours/월
- 빌드: 무제한
- 분석 및 모니터링

**예상 비용**:
- 개발 단계: 무료 (Hobby 플랜 활용)
- 초기 운영: $20/월 (프로 플랜)
- 성장 단계: 대역폭/함수 사용량에 따라 추가 비용 발생 가능

**비용 절감 전략**:
- 이미지 최적화 (Next.js Image 컴포넌트 활용)
- API 캐싱 전략 적용
- 정적 페이지 생성 (ISR) 활용

### 2. Supabase (데이터베이스)

**무료 플랜 (Free)**:
- 데이터베이스 크기: 500MB
- 월간 활성 사용자: 50,000
- API 요청: 2M/월
- 스토리지: 1GB

**Pro 플랜 ($25/월)**:
- 데이터베이스 크기: 8GB
- 월간 활성 사용자: 100,000
- API 요청: 50M/월
- 스토리지: 100GB

**예상 비용**:
- 개발 단계: 무료 (Free 플랜)
- 초기 운영: $25/월 (Pro 플랜)
- 성장 단계: 사용량에 따라 추가 비용 발생 가능

**비용 절감 전략**:
- 데이터베이스 쿼리 최적화
- 인덱스 최적화
- 불필요한 데이터 정기 정리
- RLS 정책으로 불필요한 쿼리 방지

### 3. Clerk (인증)

**무료 플랜 (Free)**:
- 월간 활성 사용자: 10,000
- SAML SSO: 1개

**필수 플랜 ($25/월)**:
- 월간 활성 사용자: 10,000
- SAML SSO: 무제한
- 추가 기능 (Organization 등)

**예상 비용**:
- 개발 단계: 무료
- 초기 운영: $25/월 (필수 플랜)
- 성장 단계: 사용자 수에 따라 추가 비용

### 4. 네이버 지도 API (NCP)

**무료 할당량**:
- Maps API: 월 5,000 건
- Geocoding API: 월 5,000 건
- Static Map API: 월 30,000 건

**과금**:
- Maps API: 건당 0.5원
- Geocoding API: 건당 0.5원
- Static Map API: 건당 0.1원

**예상 비용**:
- 개발 단계: 무료 (할당량 내)
- 초기 운영: 월 5,000-10,000원 (월 10,000-20,000 건 사용 시)
- 성장 단계: 사용량에 따라 증가

**비용 절감 전략**:
- 지도 캐싱 (정적 지도 이미지 활용)
- 지도 로드 시점 최적화 (뷰포트 내 지도만 로드)
- 동적 지도 사용 최소화

### 5. 고캠핑 API

**무료 공공 API**:
- 비용 없음 (공공데이터 포털 제공)

**비용 절감 전략**:
- API 캐싱 전략 적용 (`docs/CACHING_STRATEGY.md` 참고)
- 불필요한 API 호출 방지

## 월별 총 예상 비용

### 개발 단계 (MVP)
- Vercel: 무료
- Supabase: 무료
- Clerk: 무료
- 네이버 지도: 무료
- **총합: 무료**

### 초기 운영 단계 (사용자 1,000-10,000명)
- Vercel: $20/월
- Supabase: $25/월
- Clerk: $25/월
- 네이버 지도: 약 $5-10/월
- **총합: 약 $75-80/월**

### 성장 단계 (사용자 10,000-50,000명)
- Vercel: $20-50/월 (대역폭 증가)
- Supabase: $25-50/월 (용량 증가)
- Clerk: $25-100/월 (사용자 수 증가)
- 네이버 지도: 약 $20-50/월 (API 호출 증가)
- **총합: 약 $90-250/월**

## 비용 모니터링 방법

### 1. Vercel 대시보드
- URL: https://vercel.com/dashboard
- 대역폭, 함수 실행 시간, 빌드 횟수 확인
- 경고 알림 설정 가능

### 2. Supabase 대시보드
- URL: https://supabase.com/dashboard
- 데이터베이스 용량, API 요청 수, 스토리지 사용량 확인
- 일일/월별 사용량 추이 확인

### 3. Clerk 대시보드
- URL: https://dashboard.clerk.com
- 월간 활성 사용자 수 확인
- 사용자 증가 추이 확인

### 4. 네이버 클라우드 플랫폼 (NCP)
- URL: https://console.ncloud.com
- Maps API 사용량 확인
- 일일/월별 사용량 추이 확인
- 알림 설정 가능

## 비용 절감 체크리스트

### 즉시 적용 가능
- [x] API 캐싱 전략 적용 (`docs/CACHING_STRATEGY.md`)
- [x] 이미지 최적화 (Next.js Image 컴포넌트)
- [x] 정적 페이지 생성 (ISR) 활용
- [x] Next.js fetch 캐싱 적용 (상세: 6시간, 목록: 1시간)

### 중기 목표
- [ ] 데이터베이스 쿼리 최적화
- [ ] 인덱스 최적화
- [ ] 불필요한 데이터 정기 정리
- [ ] 지도 API 캐싱 강화

### 장기 목표
- [ ] CDN 활용 (정적 자산)
- [ ] Edge Functions 활용 (지역별 배포)
- [ ] 데이터베이스 아카이빙 (오래된 데이터)

## 비용 추적 로그

비용 관련 로그는 `lib/utils/logger.ts`의 `logCost()` 함수를 사용하여 기록합니다.

```typescript
import { logCost } from "@/lib/utils/logger";

// API 호출 비용 추적
logCost("Naver Maps API", "geocoding", 0.5);
```

## 주의사항

1. **무료 할당량 모니터링**: 각 서비스의 무료 할당량을 초과하지 않도록 주의
2. **비용 알림 설정**: 예상 비용을 초과할 경우 알림 받기
3. **정기 리뷰**: 월 1회 비용 리뷰 및 최적화 기회 검토
4. **사용량 트렌드 분석**: 사용량 증가 추이를 분석하여 필요 시 플랜 업그레이드 계획

## 참고 자료

- [Vercel 가격 정책](https://vercel.com/pricing)
- [Supabase 가격 정책](https://supabase.com/pricing)
- [Clerk 가격 정책](https://clerk.com/pricing)
- [네이버 클라우드 플랫폼 가격 정책](https://www.ncloud.com/product/applicationService/maps)

